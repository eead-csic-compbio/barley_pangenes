
perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr1H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr1Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr2H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr2Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr3H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr3Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr4H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr4Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr5H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr5Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr6H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr6Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/chr7H/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chr7Hpre.html

perl -lane 'BEGIN{print "<pre><b>chr\tstart\tend\tpangene\toccupancy\tstrand\tMorexV3\tMorex\tHockett\tHOR3081\tIgri\tHOR9043\tHOR13942\tHOR3365\tHOR13821\tRGT_Planet\tHOR10350\tHOR21599\tZDM01467\tZDM02064\tOUN333\tGolden_Promise\tHOR7552\tBarke\tAkashinriki\tB1K-04-12\tHOR8148\tBarkeBaRT2v18</b>"} next if not(/unplaced/); if($F[4]<2){ print } else { $F[3] = "<a href=\"https://www.ncbi.nlm.nih.gov/projects/msaviewer/?url=https://floresta.eead.csic.es/barley_pangenes_msa/$F[3].cds.faa\">$F[3]</a>"; print join("\t",@F) } END{ print "</pre>"}' pangene_matrix.tr.bed > pre/chrUnpre.html

## MSAs

#nohup /homes/bcontreras/panoryza/plant-scripts/pangenes/get_pangenes.pl -d barley22_BPGv2 -s '^chr\d+H' -m cluster -r MorexV3 -H -t 0 &> log.barley22_BPGv2.H.t0

# clusters with 2+ taxa
#perl -lne 'if(/^cluster \S+ size=\d+ taxa=(\d+) \S+ cdnafile: (\S+) \S+ \S+ pepfile: (\S+)/){ print "$3" if($1>1) }' barley22_BPGv2_pangenes/MorexV3_highrep_0taxa_2neigh_algMmap_split_/MorexV3.cluster_list > list.pep2.txt

#cat list.pep2.txt | parallel --gnu -j 30 /home/contrera/soft/plant-scripts/pangenes/check_quality.pl -d barley22_BPGv2_pangenes/MorexV3_highrep_0taxa_2neigh_algMmap_split_ -i {} -n -o quality.barleyBPGv2 ::: &> log.quality.barleyBPGv2.tsv


# clusters with 2+ taxa
#perl -lne 'if(/^cluster \S+ size=\d+ taxa=(\d+) \S+ cdnafile: (\S+) \S+ \S+ pepfile: (\S+)/){ print "$3" if($1 >= 2)}' MorexV3.cluster_list > list.2.pep.txt

# align protein sequences in clusters
#cd MorexV3
#cat ../list.2.pep.txt | parallel --gnu -j 16 ~/soft/clustal-omega-1.2.4/src/clustalo -i {} -o ../msa_pep/{} ::: &> ../log.msa_pep



## unused code


# {r bedtable}
# # parse pangene matrix file in BED format and add header
# bed <- read.csv(file="pangene_matrix.tr.bed", sep="\t", comment.char=";",header=F)
# names(bed) <- c("chr","start","end","pangene","occupancy","strand",
#               "MorexV3","Morex","HOR10350","RGT_Planet","HOR3081",
#               "Barke","HOR9043","HOR13821","HOR8148","Igri","HOR13942",
#               "OUN333","HOR21599","Akashinriki","HOR7552","ZDM02064",
#               "Hockett","HOR3365","ZDM01467","B1K-04-12","Golden_Promise",
#               "BarkeBaRT2v18")
#
# # one chr at a time
# bed <- bed[grep("chr1H", bed$chr), ]
#
# # build URL only for clusters with occup > 1
# bed[bed$occupancy > 1,4] <- 
#  paste0('[', bed[bed$occupancy > 1,4], '](',URL, bed[bed$occupancy > 1,4])
# bed[bed$occupancy > 1,4] <- paste0(bed[bed$occupancy > 1,4], EXT,')')
#
# # display as table
# kable(bed,format.args = list(big.mark=","), longtable=T)

